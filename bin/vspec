#!/bin/bash

if [ "$#" = '0' ] || [ "$1" = '-h' ] || [ "$1" = '--help' ]
then
  echo "Usage: $0 {input-script} [{non-standard-runtimepath} ...]"
  exit
fi

driver_script=",,$$.vim"
input_script="$1"




cat <<END >"$driver_script"
let &runtimepath = substitute(&runtimepath, \
                              '\\V' . escape(\$HOME, '\\') . '/.vim', \
                              './vim/dot.vim', \
                              'g')
1 verbose call vspec#test('$input_script')
qall!
END

vim -u NONE -i NONE -N -e -s -S "$driver_script" 2>&1 | sed "s|$(pwd)|.|g"




rm -f "$driver_script"

#__END__
